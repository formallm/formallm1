# æ¯æ—¥è‡ªåŠ¨æ›´æ–°éƒ¨ç½²æŒ‡å—

## ğŸ¯ åŠŸèƒ½è¯´æ˜

æ¯å¤©æ™šä¸Š **23:00** è‡ªåŠ¨æ‰§è¡Œï¼š

1. âœ… **æ›´æ–°å½“æ—¥æ’è¡Œæ¦œ**ï¼ˆæ—¥æ¦œ + æ€»æ¦œï¼‰
2. âœ… **åŒæ­¥ç¬¬äºŒå¤©èµ›é¢˜**ï¼ˆå¦‚æœæ–‡ä»¶å·²å‡†å¤‡å¥½ï¼‰
3. âœ… **æ¨é€åˆ° GitHub**ï¼ˆè‡ªåŠ¨è§¦å‘ GitHub Pages éƒ¨ç½²ï¼‰

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆ3 æ­¥å®Œæˆï¼‰

### ç¬¬ 1 æ­¥ï¼šä¸Šä¼ ä»£ç åˆ° GitHub

åœ¨æœ¬åœ° Windows ç”µè„‘ä¸Šæ‰§è¡Œï¼š

```powershell
cd D:\HuaweiMoveData\Users\NERV\Desktop\alailab

git add formallm1/server/
git commit -m "Add daily auto-update scripts"
git push origin main
```

### ç¬¬ 2 æ­¥ï¼šåœ¨äº‘æœåŠ¡å™¨ä¸Šé…ç½®

SSH ç™»å½•åˆ°äº‘æœåŠ¡å™¨åæ‰§è¡Œï¼š

```bash
# å…‹éš†æˆ–æ›´æ–°ä»“åº“
cd /var/www
git clone https://github.com/ä½ çš„ç”¨æˆ·å/alailab.git formallm1
# å¦‚æœå·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°ï¼š
# cd /var/www/formallm1 && git pull origin main

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/formallm1

# è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™
chmod +x server/*.sh

# é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆæ›¿æ¢ YOUR_API_KEY ä¸ºçœŸå®çš„ API Keyï¼‰
bash server/setup_cron.sh YOUR_API_KEY
```

**æç¤º**ï¼šè„šæœ¬ä¼šè¯¢é—®æ˜¯å¦ç«‹å³æµ‹è¯•æ‰§è¡Œï¼Œå»ºè®®é€‰æ‹© `y` è¿›è¡Œæµ‹è¯•ã€‚

### ç¬¬ 3 æ­¥ï¼šå‡†å¤‡æ¯æ—¥èµ›é¢˜æ–‡ä»¶

å°†èµ›é¢˜æ–‡ä»¶æ”¾åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼š

```bash
# èµ›é¢˜æ–‡ä»¶ç›®å½•
/var/www/formallm1/assets/files/

# æ–‡ä»¶å‘½åæ ¼å¼
lean_MMDD.jsonl    # ä¾‹å¦‚ï¼šlean_1107.jsonl
litex_MMDD.jsonl   # ä¾‹å¦‚ï¼šlitex_1107.jsonl
```

**ä¸Šä¼ æ–¹å¼**ï¼š

```bash
# ä»æœ¬åœ°ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp lean_1107.jsonl user@server:/var/www/formallm1/assets/files/
scp litex_1107.jsonl user@server:/var/www/formallm1/assets/files/
```

**å·¥ä½œåŸç†**ï¼š
- è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹"ç¬¬äºŒå¤©"çš„èµ›é¢˜æ–‡ä»¶
- å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè‡ªåŠ¨æ¨é€åˆ° GitHub
- å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåªæ›´æ–°æ’è¡Œæ¦œï¼ˆä¸ä¼šæŠ¥é”™ï¼‰

---

## ğŸ“‹ å·¥ä½œæµç¨‹

```
æ¯å¤© 23:00 Cron è§¦å‘
    â†“
daily_update.sh æ‰§è¡Œ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ›´æ–°æ’è¡Œæ¦œæ•°æ®                â”‚
â”‚    fetch_leaderboard.py         â”‚
â”‚    â†’ è·å–å½“æ—¥æ—¥æ¦œ               â”‚
â”‚    â†’ è·å–æ€»æ¦œ                   â”‚
â”‚    â†’ ä¿å­˜åˆ° leaderboard.json   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åŒæ­¥ç¬¬äºŒå¤©èµ›é¢˜                â”‚
â”‚    sync_daily_problems.sh       â”‚
â”‚    â†’ æ£€æŸ¥ lean_MMDD.jsonl      â”‚
â”‚    â†’ æ£€æŸ¥ litex_MMDD.jsonl     â”‚
â”‚    â†’ å¦‚æœå­˜åœ¨åˆ™æ·»åŠ åˆ° Git      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æäº¤å¹¶æ¨é€                    â”‚
â”‚    â†’ git add & commit          â”‚
â”‚    â†’ git push origin main      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
GitHub Pages è‡ªåŠ¨éƒ¨ç½²ï¼ˆ1-2åˆ†é’Ÿï¼‰
    â†“
ç”¨æˆ·è®¿é—®ç½‘ç«™çœ‹åˆ°æœ€æ–°æ•°æ® âœ¨
```

---

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹å®šæ—¶ä»»åŠ¡

```bash
# æŸ¥çœ‹æ‰€æœ‰å®šæ—¶ä»»åŠ¡
crontab -l

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
# 0 23 * * * cd /var/www/formallm1 && bash server/daily_update.sh YOUR_API_KEY >> logs/cron.log 2>&1
```

### æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—

```bash
cd /var/www/formallm1

# å®æ—¶æŸ¥çœ‹ Cron æ—¥å¿—
tail -f logs/cron.log

# æŸ¥çœ‹ä»Šå¤©çš„è¯¦ç»†æ—¥å¿—
tail -f logs/daily_$(date +%Y%m%d).log

# æŸ¥çœ‹æœ€è¿‘ 50 è¡Œ
tail -50 logs/cron.log
```

### æ‰‹åŠ¨è§¦å‘æ›´æ–°

```bash
cd /var/www/formallm1

# æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡å®Œæ•´æ›´æ–°
bash server/daily_update.sh YOUR_API_KEY
```

### åªæ›´æ–°æ’è¡Œæ¦œ

```bash
cd /var/www/formallm1
python3 server/fetch_leaderboard.py YOUR_API_KEY
```

### åªåŒæ­¥èµ›é¢˜

```bash
cd /var/www/formallm1
bash server/sync_daily_problems.sh
```

---

## ğŸ“‚ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| `server/daily_update.sh` | ğŸŒ™ ä¸»æ›´æ–°è„šæœ¬ | æ¯å¤© 23:00 æ‰§è¡Œçš„å…¥å£ |
| `server/fetch_leaderboard.py` | ğŸ“Š æ’è¡Œæ¦œæ›´æ–° | ä» API è·å–æ’è¡Œæ¦œæ•°æ® |
| `server/sync_daily_problems.sh` | ğŸ“¦ èµ›é¢˜åŒæ­¥ | æ£€æµ‹å¹¶åŒæ­¥ç¬¬äºŒå¤©èµ›é¢˜ |
| `server/setup_cron.sh` | â° Cron é…ç½® | ä¸€é”®é…ç½®å®šæ—¶ä»»åŠ¡ |

**ç”Ÿæˆçš„æ–‡ä»¶**ï¼š

| æ–‡ä»¶ | è¯´æ˜ | æ›´æ–°æ—¶é—´ |
|------|------|----------|
| `assets/data/leaderboard.json` | æ’è¡Œæ¦œæ•°æ® | æ¯å¤© 23:00 |
| `assets/files/lean_MMDD.jsonl` | Lean èµ›é¢˜ | ç¬¬äºŒå¤©èµ›é¢˜ |
| `assets/files/litex_MMDD.jsonl` | Litex èµ›é¢˜ | ç¬¬äºŒå¤©èµ›é¢˜ |
| `logs/cron.log` | Cron æ‰§è¡Œæ—¥å¿— | å®æ—¶ |
| `logs/daily_YYYYMMDD.log` | è¯¦ç»†æ‰§è¡Œæ—¥å¿— | æ¯å¤©ä¸€ä¸ª |

---

## ğŸ” éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥å®šæ—¶ä»»åŠ¡

```bash
crontab -l
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼å†…å®¹ï¼š

```
# FormaLLM æ¯æ—¥è‡ªåŠ¨æ›´æ–° (23:00)
0 23 * * * cd /var/www/formallm1 && bash server/daily_update.sh YOUR_API_KEY >> logs/cron.log 2>&1
```

### 2. æµ‹è¯•æ‰‹åŠ¨æ‰§è¡Œ

```bash
cd /var/www/formallm1
bash server/daily_update.sh YOUR_API_KEY
```

**é¢„æœŸè¾“å‡º**ï¼š

```
==========================================
ğŸŒ™ æ¯æ—¥è‡ªåŠ¨æ›´æ–°ä»»åŠ¡å¼€å§‹
==========================================
...
âœ… æ’è¡Œæ¦œæ›´æ–°æˆåŠŸ
âœ… èµ›é¢˜åŒæ­¥å®Œæˆ
âœ… æ¨é€æˆåŠŸ
==========================================
âœ… æ¯æ—¥æ›´æ–°ä»»åŠ¡å…¨éƒ¨å®Œæˆ
==========================================
```

### 3. æ£€æŸ¥ GitHub æäº¤

è®¿é—®ï¼š`https://github.com/ä½ çš„ç”¨æˆ·å/alailab/commits/main`

åº”è¯¥èƒ½çœ‹åˆ°æ–°çš„æäº¤ï¼š
```
chore: daily update - leaderboard and problems for 2025-11-06
```

### 4. æ£€æŸ¥ç½‘ç«™æ›´æ–°

è®¿é—®æ‚¨çš„ GitHub Pagesï¼ŒæŸ¥çœ‹ï¼š
- æ’è¡Œæ¦œæ•°æ®æ˜¯å¦æ›´æ–°
- ä¸‹è½½é¡µé¢æ˜¯å¦æ˜¾ç¤ºæ–°èµ›é¢˜

---

## ğŸ“… èµ›é¢˜æ–‡ä»¶ç®¡ç†

### æå‰å‡†å¤‡èµ›é¢˜

å»ºè®®æ¯å¤©ä¸‹åˆæå‰å‡†å¤‡å¥½ç¬¬äºŒå¤©çš„èµ›é¢˜ï¼š

```bash
# 1. å‡†å¤‡æ–‡ä»¶ï¼ˆåœ¨æœ¬åœ°æˆ–æœåŠ¡å™¨ï¼‰
lean_1107.jsonl
litex_1107.jsonl

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå¦‚æœåœ¨æœ¬åœ°å‡†å¤‡ï¼‰
scp lean_1107.jsonl user@server:/var/www/formallm1/assets/files/
scp litex_1107.jsonl user@server:/var/www/formallm1/assets/files/

# 3. éªŒè¯æ–‡ä»¶
ssh user@server
ls -lh /var/www/formallm1/assets/files/*.jsonl
```

### æ–‡ä»¶å‘½åè§„åˆ™

- **æ ¼å¼**ï¼š`{track}_{MMDD}.jsonl`
- **ç¤ºä¾‹**ï¼š
  - `lean_1107.jsonl` â†’ 11æœˆ7æ—¥çš„ Lean èµ›é¢˜
  - `litex_1230.jsonl` â†’ 12æœˆ30æ—¥çš„ Litex èµ›é¢˜

### è‡ªåŠ¨åŒ–å·¥ä½œæµ

```
16:00 - æ‚¨å‡†å¤‡å¥½ç¬¬äºŒå¤©èµ›é¢˜
        â†“ (ä¸Šä¼ åˆ°æœåŠ¡å™¨)
23:00 - Cron è‡ªåŠ¨æ‰§è¡Œ
        â†“ (æ£€æµ‹åˆ°æ–°æ–‡ä»¶)
23:01 - æ¨é€åˆ° GitHub
        â†“ (GitHub Pages éƒ¨ç½²)
23:03 - ç½‘ç«™æ›´æ–°å®Œæˆ âœ¨
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. API Key å®‰å…¨

- âŒ **ä¸è¦**å°† API Key æäº¤åˆ° Git
- âœ… **åªåœ¨**æœåŠ¡å™¨ Cron ä¸­ä½¿ç”¨
- âœ… å®šæœŸæ›´æ¢ API Key

### 2. æ–‡ä»¶æ ¼å¼

ç¡®ä¿èµ›é¢˜æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„ JSONL æ ¼å¼ï¼š

```bash
# éªŒè¯æ–‡ä»¶æ ¼å¼
cat assets/files/lean_1107.jsonl | head -3
# æ¯è¡Œåº”è¯¥æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ JSON å¯¹è±¡

# ä½¿ç”¨ jq éªŒè¯ï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
cat assets/files/lean_1107.jsonl | jq -c . > /dev/null && echo "âœ… æ ¼å¼æ­£ç¡®"
```

### 3. Git æƒé™

ç¡®ä¿æœåŠ¡å™¨æœ‰æƒé™æ¨é€åˆ° GitHubï¼š

```bash
# æµ‹è¯• SSH è¿æ¥
ssh -T git@github.com

# åº”è¯¥çœ‹åˆ°ï¼š
# Hi username! You've successfully authenticated...

# å¦‚æœå¤±è´¥ï¼Œé…ç½® Deploy Keyï¼ˆè§ä¸‹æ–¹ï¼‰
```

---

## ğŸ” é…ç½® GitHub Deploy Key

### ç”Ÿæˆ SSH å¯†é’¥

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# ç”Ÿæˆå¯†é’¥ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
ssh-keygen -t ed25519 -C "formallm-server" -f ~/.ssh/formallm_deploy

# æŸ¥çœ‹å…¬é’¥
cat ~/.ssh/formallm_deploy.pub
```

### æ·»åŠ åˆ° GitHub

1. å¤åˆ¶å…¬é’¥å†…å®¹
2. è®¿é—®ï¼š`https://github.com/ä½ çš„ç”¨æˆ·å/alailab/settings/keys`
3. ç‚¹å‡» **"Add deploy key"**
4. å¡«å†™ï¼š
   - **Title**: `Cloud Server Auto Update`
   - **Key**: ç²˜è´´å…¬é’¥
   - âœ… **å‹¾é€‰** `Allow write access`ï¼ˆé‡è¦ï¼ï¼‰
5. ç‚¹å‡» **"Add key"**

### é…ç½® Git ä½¿ç”¨å¯†é’¥

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# æ·»åŠ  SSH é…ç½®
cat >> ~/.ssh/config << 'EOF'
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/formallm_deploy
    IdentitiesOnly yes
EOF

# æµ‹è¯•è¿æ¥
ssh -T git@github.com
```

---

## ğŸ§¹ ç»´æŠ¤ä»»åŠ¡

### æ¸…ç†æ—§æ—¥å¿—

```bash
# åˆ é™¤ 30 å¤©å‰çš„æ—¥å¿—
find /var/www/formallm1/logs -name "*.log" -mtime +30 -delete

# æˆ–è€…æ·»åŠ åˆ° Cronï¼ˆæ¯å‘¨æ—¥å‡Œæ™¨ 3 ç‚¹ï¼‰
# 0 3 * * 0 find /var/www/formallm1/logs -name "*.log" -mtime +30 -delete
```

### æ›´æ–°ä»£ç 

```bash
cd /var/www/formallm1

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°è®¾ç½®æƒé™ï¼ˆå¦‚æœæœ‰æ–°è„šæœ¬ï¼‰
chmod +x server/*.sh
```

### ä¿®æ”¹æ‰§è¡Œæ—¶é—´

```bash
# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
crontab -e

# ä¿®æ”¹æ—¶é—´ï¼ˆä¾‹å¦‚æ”¹ä¸º 22:00ï¼‰
# 0 22 * * * cd /var/www/formallm1 && bash server/daily_update.sh YOUR_API_KEY >> logs/cron.log 2>&1
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šå®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œ

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥ Cron æœåŠ¡
sudo systemctl status cron

# 2. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
sudo grep CRON /var/log/syslog | tail -20

# 3. æ£€æŸ¥è„šæœ¬æƒé™
ls -l /var/www/formallm1/server/*.sh

# 4. æ‰‹åŠ¨æµ‹è¯•
bash /var/www/formallm1/server/daily_update.sh YOUR_API_KEY
```

### é—®é¢˜ï¼šæ¨é€å¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥ Git é…ç½®
cd /var/www/formallm1
git remote -v

# 2. æµ‹è¯• SSH
ssh -T git@github.com

# 3. æŸ¥çœ‹è¯¦ç»†é”™è¯¯
git push origin main -v

# 4. æ£€æŸ¥ Deploy Key æƒé™
# è®¿é—®: https://github.com/ä½ çš„ç”¨æˆ·å/alailab/settings/keys
# ç¡®ä¿å‹¾é€‰äº† "Allow write access"
```

### é—®é¢˜ï¼šèµ›é¢˜æ–‡ä»¶æœªåŒæ­¥

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
TOMORROW=$(date -d "tomorrow" +%m%d)
ls -lh /var/www/formallm1/assets/files/*_${TOMORROW}.jsonl

# 2. æ£€æŸ¥æ–‡ä»¶å‘½åæ ¼å¼
# å¿…é¡»æ˜¯: lean_MMDD.jsonl å’Œ litex_MMDD.jsonl

# 3. æ‰‹åŠ¨æµ‹è¯•åŒæ­¥
bash /var/www/formallm1/server/sync_daily_problems.sh

# 4. æŸ¥çœ‹æ—¥å¿—
tail -20 /var/www/formallm1/logs/sync_$(date +%Y%m%d).log
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. ğŸ“ **æŸ¥çœ‹æ—¥å¿—**ï¼š`tail -50 logs/cron.log`
2. ğŸ§ª **æ‰‹åŠ¨æµ‹è¯•**ï¼š`bash server/daily_update.sh YOUR_API_KEY`
3. ğŸ” **æ£€æŸ¥æƒé™**ï¼š`ls -l server/*.sh`
4. ğŸ“– **æŸ¥çœ‹è¯¦ç»†æŒ‡å—**ï¼š`SERVER_DEPLOYMENT_GUIDE.md`

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²æ¨é€åˆ° GitHub
- [ ] äº‘æœåŠ¡å™¨å·²å…‹éš†ä»“åº“
- [ ] è„šæœ¬æƒé™å·²è®¾ç½®ï¼ˆ`chmod +x server/*.sh`ï¼‰
- [ ] Cron å®šæ—¶ä»»åŠ¡å·²é…ç½®
- [ ] Deploy Key å·²æ·»åŠ åˆ° GitHubï¼ˆå‹¾é€‰ write accessï¼‰
- [ ] æ‰‹åŠ¨æµ‹è¯•æ‰§è¡ŒæˆåŠŸ
- [ ] èƒ½çœ‹åˆ° GitHub æäº¤è®°å½•
- [ ] ç½‘ç«™èƒ½æ­£å¸¸æ˜¾ç¤ºæ•°æ®
- [ ] çŸ¥é“å¦‚ä½•æŸ¥çœ‹æ—¥å¿—
- [ ] çŸ¥é“å¦‚ä½•ä¸Šä¼ èµ›é¢˜æ–‡ä»¶

---

**ğŸ‰ éƒ¨ç½²å®Œæˆï¼ä»ä»Šæ™š 23:00 å¼€å§‹ï¼Œç³»ç»Ÿå°†å…¨è‡ªåŠ¨è¿è¡Œã€‚**

**ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´**ï¼šä»Šæ™š 23:00

**æ¨èæ“ä½œ**ï¼š
1. ä»Šå¤©ä¸‹åˆå‡†å¤‡å¥½æ˜å¤©ï¼ˆ11æœˆ7æ—¥ï¼‰çš„èµ›é¢˜æ–‡ä»¶
2. ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š`/var/www/formallm1/assets/files/`
3. ä»Šæ™š 23:00 åæŸ¥çœ‹æ—¥å¿—éªŒè¯æ‰§è¡Œ

