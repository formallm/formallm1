# è‡ªåŠ¨æ›´æ–°è„šæœ¬è¯´æ˜

æœ¬ç›®å½•åŒ…å«ç”¨äºè‡ªåŠ¨æ›´æ–°æ’è¡Œæ¦œå’Œèµ›é¢˜æ•°æ®çš„è„šæœ¬ã€‚

## ğŸ“ æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `update-data.sh` | ä¸»æ›´æ–°è„šæœ¬ï¼šæ‹‰å–æ•°æ®ã€éªŒè¯ã€æ¨é€åˆ°GitHub |
| `setup-github.sh` | GitHub SSHé…ç½®è„šæœ¬ |
| `setup-cron.sh` | å®šæ—¶ä»»åŠ¡é…ç½®è„šæœ¬ |
| `manual-update.sh` | æ‰‹åŠ¨è§¦å‘æ›´æ–°ï¼ˆç”¨äºæµ‹è¯•ï¼‰ |
| `QUICKSTART.md` | 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹æŒ‡å— â­ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### é¦–æ¬¡éƒ¨ç½²

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
cd /var/www/formsci

# 2. è®¾ç½®æ‰§è¡Œæƒé™
chmod +x scripts/*.sh

# 3. é…ç½®GitHubï¼ˆéœ€è¦æ·»åŠ Deploy Keyï¼‰
bash scripts/setup-github.sh

# 4. é…ç½®å®šæ—¶ä»»åŠ¡
bash scripts/setup-cron.sh

# 5. æµ‹è¯•æ›´æ–°
bash scripts/manual-update.sh
```

**è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹ï¼š[QUICKSTART.md](./QUICKSTART.md)** â­

## ğŸ“– å®Œæ•´æ–‡æ¡£

å®Œæ•´çš„éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ï¼š[../DEPLOY_GUIDE.md](../DEPLOY_GUIDE.md)

å†…å®¹åŒ…æ‹¬ï¼š
- è¯¦ç»†çš„éƒ¨ç½²æ­¥éª¤
- APIæ•°æ®æ ¼å¼è¯´æ˜
- ç›‘æ§å’Œç»´æŠ¤æ–¹æ³•
- æ•…éšœæ’æŸ¥æŒ‡å—
- å®‰å…¨å»ºè®®
- é«˜çº§é…ç½®é€‰é¡¹

## ğŸ”§ è„šæœ¬åŠŸèƒ½

### update-data.sh

ä¸»è¦åŠŸèƒ½ï¼š
- ä»ç™½åå•æœåŠ¡å™¨è·å–æ’è¡Œæ¦œæ•°æ®
- ä»ç™½åå•æœåŠ¡å™¨è·å–æ¯æ—¥èµ›é¢˜æ•°æ®
- éªŒè¯JSONæ ¼å¼
- è‡ªåŠ¨æäº¤å¹¶æ¨é€åˆ°GitHub
- å®Œæ•´çš„æ—¥å¿—è®°å½•

é…ç½®é¡¹ï¼š
```bash
LEADERBOARD_API="http://121.43.230.124/results/leaderboard"
PROBLEMS_API="http://121.43.230.124/results/daily/{{DATE}}"
REPO_DIR="/var/www/formsci"
GIT_BRANCH="main"
```

### setup-github.sh

åŠŸèƒ½ï¼š
- ç”ŸæˆSSHå¯†é’¥
- é…ç½®Gitç”¨æˆ·ä¿¡æ¯
- æµ‹è¯•GitHubè¿æ¥
- åˆå§‹åŒ–Gitä»“åº“

### setup-cron.sh

åŠŸèƒ½ï¼š
- é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨1ç‚¹å’Œä¸‹åˆ1ç‚¹ï¼‰
- åˆ›å»ºæ—¥å¿—ç›®å½•
- å¤‡ä»½ç°æœ‰crontab

### manual-update.sh

åŠŸèƒ½ï¼š
- æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ•°æ®æ›´æ–°
- ç”¨äºæµ‹è¯•å’Œè°ƒè¯•

## ğŸ“Š æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™½åå•æœåŠ¡å™¨            â”‚
â”‚  121.43.230.124         â”‚
â”‚  - æ’è¡Œæ¦œAPI            â”‚
â”‚  - æ¯æ—¥èµ›é¢˜API          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ HTTPè¯·æ±‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‘æœåŠ¡å™¨                â”‚
â”‚  - cronå®šæ—¶ä»»åŠ¡         â”‚
â”‚  - update-data.sh       â”‚
â”‚  - æ•°æ®éªŒè¯ä¸å¤„ç†       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ Git Push
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHubä»“åº“              â”‚
â”‚  - è‡ªåŠ¨è§¦å‘Actions      â”‚
â”‚  - éƒ¨ç½²åˆ°Pages          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ è‡ªåŠ¨éƒ¨ç½²
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Pages           â”‚
â”‚  - é™æ€ç½‘ç«™              â”‚
â”‚  - ç”¨æˆ·è®¿é—®              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ• å®šæ—¶ä»»åŠ¡

é»˜è®¤é…ç½®ï¼š
```cron
0 1,13 * * * /var/www/formsci/scripts/update-data.sh
```

æ‰§è¡Œæ—¶é—´ï¼š
- æ¯å¤© **01:00**ï¼ˆå‡Œæ™¨1ç‚¹ï¼‰
- æ¯å¤© **13:00**ï¼ˆä¸‹åˆ1ç‚¹ï¼‰

ä¿®æ”¹é¢‘ç‡ï¼š
```bash
crontab -e

# ç¤ºä¾‹ï¼šæ¯å°æ—¶æ‰§è¡Œ
0 * * * * /var/www/formsci/scripts/update-data.sh >> /var/log/formsci-update/cron.log 2>&1

# ç¤ºä¾‹ï¼šæ¯6å°æ—¶æ‰§è¡Œ
0 */6 * * * /var/www/formsci/scripts/update-data.sh >> /var/log/formsci-update/cron.log 2>&1
```

## ğŸ“ æ—¥å¿—ä½ç½®

```
/var/log/formsci-update/
â”œâ”€â”€ update-20251030.log   # æ¯æ—¥è¯¦ç»†æ—¥å¿—
â”œâ”€â”€ update-20251031.log
â””â”€â”€ cron.log               # Cronæ‰§è¡Œæ—¥å¿—
```

æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
# æŸ¥çœ‹ä»Šå¤©çš„æ—¥å¿—
tail -f /var/log/formsci-update/update-$(date +%Y%m%d).log

# æŸ¥çœ‹cronæ—¥å¿—
tail -f /var/log/formsci-update/cron.log

# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
ls -lh /var/log/formsci-update/
```

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥å®šæ—¶ä»»åŠ¡
```bash
crontab -l
```

### 2. æ‰‹åŠ¨æµ‹è¯•
```bash
bash scripts/manual-update.sh
```

### 3. æŸ¥çœ‹GitHubæäº¤
```bash
cd /var/www/formsci
git log --oneline -5
```

### 4. è®¿é—®ç½‘ç«™
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`https://your-username.github.io/alailab/leaderboard.html`

## ğŸ› æ•…éšœæ’æŸ¥

### æ¨é€å¤±è´¥

```bash
# æµ‹è¯•SSHè¿æ¥
ssh -T git@github.com

# æ£€æŸ¥Deploy Keyæƒé™
# GitHub â†’ Settings â†’ Deploy keys â†’ ç¡®ä¿å‹¾é€‰ "Allow write access"
```

### æ•°æ®ä¸‹è½½å¤±è´¥

```bash
# æµ‹è¯•APIè¿æ¥
curl -v http://121.43.230.124/results/leaderboard

# æ£€æŸ¥æœåŠ¡å™¨IPæ˜¯å¦åœ¨ç™½åå•
```

### JSONéªŒè¯å¤±è´¥

```bash
# æ£€æŸ¥JSONæ ¼å¼
curl http://121.43.230.124/results/leaderboard | jq .
```

### å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œ

```bash
# æ£€æŸ¥cronæœåŠ¡
sudo systemctl status cron

# æ£€æŸ¥è„šæœ¬æƒé™
ls -l scripts/update-data.sh

# æŸ¥çœ‹cronæ—¥å¿—
tail -f /var/log/formsci-update/cron.log
```

## ğŸ”’ å®‰å…¨æç¤º

1. âœ“ SSHå¯†é’¥åªç”¨äºæ­¤ä»“åº“çš„Deploy Key
2. âœ“ å®šæœŸæ£€æŸ¥æ—¥å¿—ï¼Œç›‘æ§å¼‚å¸¸æ¨é€
3. âœ“ é™åˆ¶APIè®¿é—®ï¼Œä½¿ç”¨IPç™½åå•
4. âœ“ å®šæœŸæ›´æ–°ç³»ç»Ÿä¾èµ–ï¼ˆgitã€curlã€jqï¼‰

## ğŸ“ è·å–å¸®åŠ©

é‡åˆ°é—®é¢˜è¯·æ£€æŸ¥ï¼š
1. [QUICKSTART.md](./QUICKSTART.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—
2. [../DEPLOY_GUIDE.md](../DEPLOY_GUIDE.md) - å®Œæ•´éƒ¨ç½²æŒ‡å—
3. `/var/log/formsci-update/` - æ—¥å¿—æ–‡ä»¶
4. GitHubä»“åº“çš„Issuesé¡µé¢

## ğŸ“„ è®¸å¯

æœ¬è„šæœ¬é›†ä¸ºé¡¹ç›®å†…éƒ¨ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå…¶ä»–ç”¨é€”ã€‚

